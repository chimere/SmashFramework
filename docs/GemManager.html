<!DOCTYPE html>  <html> <head>   <title>GemManager.as</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">        <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                   <b> 1. First Steps </b>                          <a class="source" href="PBEDemos.html">       PBEDemos.as      </a>                          <a class="source" href="SimplestRendererScene.html">       SimplestRendererScene.as      </a>                          <a class="source" href="SimplestSpriteRenderer.html">       SimplestSpriteRenderer.as      </a>                          <a class="source" href="BindingDemoScene.html">       BindingDemoScene.as      </a>                          <a class="source" href="SimplestSpatialComponent.html">       SimplestSpatialComponent.as      </a>                          <a class="source" href="MouseFollowerScene.html">       MouseFollowerScene.as      </a>                          <a class="source" href="SimplestMouseFollowComponent.html">       SimplestMouseFollowComponent.as      </a>                          <a class="source" href="CirclePickupScene.html">       CirclePickupScene.as      </a>                          <a class="source" href="GemManager.html">       GemManager.as      </a>                          <b> 2. Building Gameplay </b>                          <a class="source" href="CirclePickupWithTimeManagerScene.html">       CirclePickupWithTimeManagerScene.as      </a>                          <a class="source" href="OneButtonDemoScene.html">       OneButtonDemoScene.as      </a>                          <a class="source" href="OneButtonWithTweenDemoScene.html">       OneButtonWithTweenDemoScene.as      </a>                          <a class="source" href="TwoButtonDemoScene.html">       TwoButtonDemoScene.as      </a>                          <a class="source" href="CarDemoScene.html">       CarDemoScene.as      </a>                          <a class="source" href="FSMDemoScene.html">       FSMDemoScene.as      </a>                               </div>         </div>       </div>      <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs" colspan="2">             <h1>               GemManager.as             </h1>           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>The GemManager is a simple manager class to kill objects in a set when
another object moves close to them. We could have put all of this logic
in the CirclePickupScene, and for this example, it would probably have 
been just fine. However, PBE is meant to be industrial strength - and in
a large project with many game mechanics, you would have to have abstraction
like this to survive!</p>

<p>In other words, consider this a building block that you can use or not as
it fits your project.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">package</span> <span class="nx">demos</span><span class="p">.</span><span class="nx">demo_04_circlePickup</span>
<span class="p">{</span>
    <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">pblabs</span><span class="p">.</span><span class="nx">core</span><span class="p">.</span><span class="nx">PBSet</span><span class="o">;</span>
    
    <span class="kd">import</span> <span class="nx">flash</span><span class="p">.</span><span class="nx">geom</span><span class="p">.</span><span class="nb">Point</span><span class="o">;</span>
    <span class="kd">import</span> <span class="nx">demos</span><span class="p">.</span><span class="nx">SimplestDemoGameObject</span><span class="o">;</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h2>Implementation</h2>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">public</span> <span class="kd">class</span> <span class="nx">GemManager</span>
    <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Reference to the PBSet holding the gems - the game objects we want
to pick up. This is set by whoever creates us.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="k">var</span> <span class="nx">gemSet</span><span class="o">:</span><span class="nx">PBSet</span><span class="o">;</span>
        </pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Reference to the game object that is gonna do the picking up.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="k">var</span> <span class="nx">pickerUpper</span><span class="o">:</span><span class="nx">SimplestDemoGameObject</span><span class="o">;</span>
        </pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>How close do we have to be to one of the gem game objects before we
pick it up?</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="k">var</span> <span class="nx">collisionRadius</span><span class="o">:</span><span class="nb">Number</span> <span class="o">=</span> <span class="mi">35</span><span class="o">;</span>
        </pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Called every frame by the CirclePickupScene to check if we should
pick something up.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="kd">function</span> <span class="nx">process</span><span class="p">()</span><span class="o">:</span><span class="nx">void</span>
        <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Find all circles within radius px of the pickerupper
and destroy() them.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="kd">const</span> <span class="nx">pickerPos</span><span class="o">:</span><span class="nb">Point</span> <span class="o">=</span> <span class="nx">pickerUpper</span><span class="p">.</span><span class="nx">spatial</span><span class="p">.</span><span class="nx">position</span><span class="o">;</span>
            </pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>We could accelerate this with a more advanced data structure 
(like a loose quadtree) but for small numbers of objects this
works just fine.</p>

<p>Iterate over every gem.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">for</span><span class="p">(</span><span class="k">var</span> <span class="nx">i</span><span class="o">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">gemSet</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
            <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>See if the gem is in range...</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="kd">const</span> <span class="nx">circle</span><span class="o">:</span><span class="nx">SimplestDemoGameObject</span> <span class="o">=</span> <span class="nx">gemSet</span><span class="p">.</span><span class="nx">getPBObjectAt</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">SimplestDemoGameObject</span><span class="o">;</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">Point</span><span class="p">.</span><span class="nx">distance</span><span class="p">(</span><span class="nx">circle</span><span class="p">.</span><span class="nx">spatial</span><span class="p">.</span><span class="nx">position</span><span class="o">,</span> <span class="nx">pickerPos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nx">collisionRadius</span><span class="p">)</span>
                    <span class="k">continue</span><span class="o">;</span>
                </pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>It was, so nuke it! And decrement i so we don't skip 
anything.</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="nx">circle</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
                <span class="nx">i</span><span class="o">--;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// @docco-chapter 1. First Steps</span>
<span class="c1">// @docco-order 9</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 