<!DOCTYPE html>  <html> <head>   <title>PBGameObject.as</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">        <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                   <b> 1. First Steps </b>                          <a class="source" href="PBEDemos.html">       PBEDemos.as      </a>                          <a class="source" href="SimplestRendererScene.html">       SimplestRendererScene.as      </a>                          <a class="source" href="SimplestSpriteRenderer.html">       SimplestSpriteRenderer.as      </a>                          <a class="source" href="BindingDemoScene.html">       BindingDemoScene.as      </a>                          <a class="source" href="SimplestSpatialComponent.html">       SimplestSpatialComponent.as      </a>                          <a class="source" href="MouseFollowerScene.html">       MouseFollowerScene.as      </a>                          <a class="source" href="SimplestMouseFollowComponent.html">       SimplestMouseFollowComponent.as      </a>                          <a class="source" href="CirclePickupScene.html">       CirclePickupScene.as      </a>                          <a class="source" href="GemManager.html">       GemManager.as      </a>                          <b> 2. Building Gameplay </b>                          <a class="source" href="CirclePickupWithTimeManagerScene.html">       CirclePickupWithTimeManagerScene.as      </a>                          <a class="source" href="OneButtonDemoScene.html">       OneButtonDemoScene.as      </a>                          <a class="source" href="OneButtonWithTweenDemoScene.html">       OneButtonWithTweenDemoScene.as      </a>                          <a class="source" href="TwoButtonDemoScene.html">       TwoButtonDemoScene.as      </a>                          <a class="source" href="CarDemoScene.html">       CarDemoScene.as      </a>                          <a class="source" href="FSMDemoScene.html">       FSMDemoScene.as      </a>                               </div>         </div>       </div>      <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs" colspan="2">             <h1>               PBGameObject.as             </h1>           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="kd">package</span> <span class="nx">com</span><span class="p">.</span><span class="nx">pblabs</span><span class="p">.</span><span class="nx">core</span>
<span class="p">{</span>
    <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">pblabs</span><span class="p">.</span><span class="nx">pb_internal</span><span class="o">;</span>
    <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">pblabs</span><span class="p">.</span><span class="nx">property</span><span class="p">.</span><span class="nx">PropertyManager</span><span class="o">;</span>
    <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">pblabs</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">TypeUtility</span><span class="o">;</span>
    
    <span class="kd">import</span> <span class="nx">flash</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nb">Dictionary</span><span class="o">;</span>
    
    <span class="nx">use</span> <span class="kd">namespace</span> <span class="nx">pb_internal</span><span class="o">;</span>
    </pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Container class for PBComponent. Most game objects are made by 
instantiating PBGameObject and filling it with one or more PBComponent
instances.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">public</span> <span class="kd">class</span> <span class="nx">PBGameObject</span> <span class="kd">extends</span> <span class="nx">PBObject</span>
    <span class="p">{</span>
        <span class="kd">private</span> <span class="k">var</span> <span class="nx">_deferring</span><span class="o">:</span><span class="nb">Boolean</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
        <span class="kd">private</span> <span class="k">var</span> <span class="nx">_components</span><span class="o">:</span><span class="nb">Dictionary</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Dictionary</span><span class="p">();</span>
        
        <span class="kd">public</span> <span class="kd">function</span> <span class="nx">PBGameObject</span><span class="p">(</span><span class="nx">_name</span><span class="o">:</span><span class="nb">String</span> <span class="o">=</span> <span class="kc">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kd">super</span><span class="p">(</span><span class="nx">_name</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="kd">public</span> <span class="kd">function</span> <span class="kd">get</span> <span class="nx">deferring</span><span class="p">()</span><span class="o">:</span><span class="nb">Boolean</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nx">_deferring</span><span class="o">;</span>
        <span class="p">}</span>
        </pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>If true, then components that are added aren't registered until 
deferring is set to false. This is used when you are adding a lot of
components, or you are adding components with cyclical dependencies
and need them to all be present on the PBGameObject before their
onAdd methods are called.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="kd">function</span> <span class="kd">set</span> <span class="nx">deferring</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="nb">Boolean</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">_deferring</span> <span class="o">&amp;&amp;</span> <span class="nx">value</span> <span class="o">==</span> <span class="kc">false</span><span class="p">)</span>
            <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Loop as long as we keep finding deferred stuff, the 
dictionary delete operations can mess up ordering so we have
to check to avoid missing stuff. This is a little lame but
our previous implementation involved allocating lots of 
temporary helper objects, which this avoids, so there you go.</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="k">var</span> <span class="nx">foundDeferred</span><span class="o">:</span><span class="nb">Boolean</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
                
                <span class="k">while</span><span class="p">(</span><span class="nx">foundDeferred</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="nx">foundDeferred</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
                    </pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Initialize deferred components.</p>             </td>             <td class="code">               <div class="highlight"><pre>                    <span class="k">for</span><span class="p">(</span><span class="k">var</span> <span class="nx">key</span><span class="o">:</span><span class="nb">String</span> <span class="k">in</span> <span class="nx">_components</span><span class="p">)</span>
                    <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Normal entries just have alphanumeric.</p>             </td>             <td class="code">               <div class="highlight"><pre>                        <span class="k">if</span><span class="p">(</span><span class="nx">key</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;!&quot;</span><span class="p">)</span>
                            <span class="k">continue</span><span class="o">;</span>
                        </pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>It's a deferral, so init it...</p>             </td>             <td class="code">               <div class="highlight"><pre>                        <span class="nx">doInitialize</span><span class="p">(</span><span class="nx">_components</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="nx">as</span> <span class="nx">PBComponent</span><span class="p">);</span>
                        </pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>... and nuke the entry.</p>             </td>             <td class="code">               <div class="highlight"><pre>                        <span class="nx">_components</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
                        <span class="nx">delete</span> <span class="nx">_components</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
                        </pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Indicate we found stuff so keep looking. Otherwise
we may miss some.</p>             </td>             <td class="code">               <div class="highlight"><pre>                        <span class="nx">foundDeferred</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            
            <span class="nx">_deferring</span> <span class="o">=</span> <span class="nx">value</span><span class="o">;</span>
        <span class="p">}</span>
        
        <span class="kd">protected</span> <span class="kd">function</span> <span class="nx">doInitialize</span><span class="p">(</span><span class="nx">component</span><span class="o">:</span><span class="nx">PBComponent</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
        <span class="p">{</span>
            <span class="nx">component</span><span class="p">.</span><span class="nx">_owner</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
            <span class="nx">owningGroup</span><span class="p">.</span><span class="nx">injectInto</span><span class="p">(</span><span class="nx">component</span><span class="p">);</span>
            <span class="nx">component</span><span class="p">.</span><span class="nx">doAdd</span><span class="p">();</span>
        <span class="p">}</span>
        </pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Add a component to the PBGameObject. Subject to the deferring flag,
the component will be initialized immediately.</p>

<p>If there is a public var on this PBGameObject (ie, you've subclassed
PBGameObject) with the same name as the component has, it will be
populated with a reference to the component. This way you can get
typed access to components on your game objects.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="kd">function</span> <span class="nx">addComponent</span><span class="p">(</span><span class="nx">component</span><span class="o">:</span><span class="nx">PBComponent</span><span class="o">,</span> <span class="nx">name</span><span class="o">:</span><span class="nb">String</span> <span class="o">=</span> <span class="kc">null</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
                <span class="nx">component</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="o">;</span>
            
            <span class="k">if</span><span class="p">(</span><span class="nx">component</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">component</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Can&#39;t add component with no name.&quot;</span><span class="p">);</span>
            </pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Stuff in dictionary.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">_components</span><span class="p">[</span><span class="nx">component</span><span class="p">.</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">component</span><span class="o">;</span>
            </pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Set component owner.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">component</span><span class="p">.</span><span class="nx">_owner</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
            </pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Directly set field if present.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span><span class="p">(</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">component</span><span class="p">.</span><span class="nx">name</span><span class="p">))</span>
                <span class="k">this</span><span class="p">[</span><span class="nx">component</span><span class="p">.</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">component</span><span class="o">;</span>
            </pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Defer or add now.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span><span class="p">(</span><span class="nx">_deferring</span><span class="p">)</span>
                <span class="nx">_components</span><span class="p">[</span><span class="s2">&quot;!&quot;</span> <span class="o">+</span> <span class="nx">component</span><span class="p">.</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">component</span><span class="o">;</span>
            <span class="k">else</span>
                <span class="nx">doInitialize</span><span class="p">(</span><span class="nx">component</span><span class="p">);</span>
        <span class="p">}</span>
        </pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Remove a component from this game object.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="kd">function</span> <span class="nx">removeComponent</span><span class="p">(</span><span class="nx">component</span><span class="o">:</span><span class="nx">PBComponent</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">component</span><span class="p">.</span><span class="nx">owner</span> <span class="o">!=</span> <span class="k">this</span><span class="p">)</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Tried to remove a component that does not belong to this PBGameObject.&quot;</span><span class="p">);</span>
            
            <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">component</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">[</span><span class="nx">component</span><span class="p">.</span><span class="nx">name</span><span class="p">]</span> <span class="o">==</span> <span class="nx">component</span><span class="p">)</span>
                <span class="k">this</span><span class="p">[</span><span class="nx">component</span><span class="p">.</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
            
            <span class="nx">_components</span><span class="p">[</span><span class="nx">component</span><span class="p">.</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
            <span class="nx">delete</span> <span class="nx">_components</span><span class="p">[</span><span class="nx">component</span><span class="p">.</span><span class="nx">name</span><span class="p">];</span>            
            <span class="nx">component</span><span class="p">.</span><span class="nx">doRemove</span><span class="p">();</span>
            <span class="nx">component</span><span class="p">.</span><span class="nx">_owner</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="p">}</span>
        </pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Look up a component by name.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="kd">function</span> <span class="nx">lookupComponent</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="nb">String</span><span class="p">)</span><span class="o">:*</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nx">_components</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="nx">as</span> <span class="nx">PBComponent</span><span class="o">;</span>
        <span class="p">}</span>
        </pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Get a fresh Vector with references to all the components in this
game object.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="kd">function</span> <span class="nx">getAllComponents</span><span class="p">()</span><span class="o">:</span><span class="nx">Vector</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">PBComponent</span><span class="o">&gt;</span>
        <span class="p">{</span>
            <span class="k">var</span> <span class="nx">out</span><span class="o">:</span><span class="nx">Vector</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">PBComponent</span><span class="o">&gt;</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vector</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">PBComponent</span><span class="o">&gt;</span><span class="p">();</span>
            <span class="k">for</span><span class="p">(</span><span class="k">var</span> <span class="nx">key</span><span class="o">:</span><span class="nb">String</span> <span class="k">in</span> <span class="nx">_components</span><span class="p">)</span>
                <span class="nx">out</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">_components</span><span class="p">[</span><span class="nx">key</span><span class="p">]);</span>
            <span class="k">return</span> <span class="nx">out</span><span class="o">;</span>
        <span class="p">}</span>
        </pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Initialize the game object! This is done in a couple of stages.</p>

<p>First, the PBObject initialization is performed.
Second, we look for any components in public vars on the PBGameObject.
This allows you to get at them by direct typed references instead of
doing lookups. If we find any, we add them to the game object.
Third, we turn off the deferring flag, so any components you've added
via addComponent get initialized.
Fourth, dependency injection is performed on ourselves and our components. 
Finally, we call applyBindings to make sure we have the latest data
for any registered data bindings.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="kd">override</span> <span class="kd">function</span> <span class="nx">initialize</span><span class="p">()</span><span class="o">:</span><span class="nx">void</span>
        <span class="p">{</span>
            <span class="kd">super</span><span class="p">.</span><span class="nx">initialize</span><span class="p">();</span>
            </pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Look for un-added members.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">for</span> <span class="k">each</span><span class="p">(</span><span class="k">var</span> <span class="nx">key</span><span class="o">:</span><span class="nb">String</span> <span class="k">in</span> <span class="nx">TypeUtility</span><span class="p">.</span><span class="nx">getListOfPublicFields</span><span class="p">(</span><span class="k">this</span><span class="p">))</span>
            <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Only consider components.</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="nx">is</span> <span class="nx">PBComponent</span><span class="p">))</span>
                    <span class="k">continue</span><span class="o">;</span>
                </pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Don't double initialize.</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">key</span><span class="p">].</span><span class="nx">owner</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
                    <span class="k">continue</span><span class="o">;</span>
                </pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>OK, add the component.</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="kd">const</span> <span class="nx">nc</span><span class="o">:</span><span class="nx">PBComponent</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="nx">as</span> <span class="nx">PBComponent</span><span class="o">;</span>
                
                <span class="k">if</span><span class="p">(</span><span class="nx">nc</span><span class="p">.</span><span class="nx">name</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">nc</span><span class="p">.</span><span class="nx">name</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">nc</span><span class="p">.</span><span class="nx">name</span> <span class="o">!=</span> <span class="nx">key</span><span class="p">)</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;PBComponent has name &#39;&quot;</span> <span class="o">+</span> <span class="nx">nc</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;&#39; but is set into field named &#39;&quot;</span> <span class="o">+</span> <span class="nx">key</span> <span class="o">+</span> <span class="s2">&quot;&#39;, these need to match!&quot;</span><span class="p">);</span>
                
                <span class="nx">nc</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">key</span><span class="o">;</span>
                <span class="nx">addComponent</span><span class="p">(</span><span class="nx">nc</span><span class="p">);</span>
            <span class="p">}</span>
            </pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Inject ourselves.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">owningGroup</span><span class="p">.</span><span class="nx">injectInto</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            </pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Stop deferring and let init happen.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">deferring</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            </pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Propagate bindings on everything.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">for</span><span class="p">(</span><span class="k">var</span> <span class="nx">key2</span><span class="o">:</span><span class="nb">String</span> <span class="k">in</span> <span class="nx">_components</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">_components</span><span class="p">[</span><span class="nx">key2</span><span class="p">].</span><span class="nx">propertyManager</span><span class="p">)</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Failed to inject component properly.&quot;</span><span class="p">);</span>
                <span class="nx">_components</span><span class="p">[</span><span class="nx">key2</span><span class="p">].</span><span class="nx">applyBindings</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
        </pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>Removes any components on this game object, then does normal PBObject
destruction (ie, remove from any groups or sets).</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="kd">override</span> <span class="kd">function</span> <span class="nx">destroy</span><span class="p">()</span><span class="o">:</span><span class="nx">void</span>
        <span class="p">{</span>
            <span class="k">for</span><span class="p">(</span><span class="k">var</span> <span class="nx">key</span><span class="o">:</span><span class="nb">String</span> <span class="k">in</span> <span class="nx">_components</span><span class="p">)</span>
                <span class="nx">removeComponent</span><span class="p">(</span><span class="nx">_components</span><span class="p">[</span><span class="nx">key</span><span class="p">]);</span>
            
            <span class="kd">super</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
        <span class="p">}</span>
        </pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Get a value from this game object in a data driven way. 
@param property Property string to look up, ie "@componentName.fieldName"
@param defaultValue A default value to return if the desired property is absent.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="kd">function</span> <span class="nx">getProperty</span><span class="p">(</span><span class="nx">property</span><span class="o">:</span><span class="nb">String</span><span class="o">,</span> <span class="nx">defaultValue</span><span class="o">:*</span> <span class="o">=</span> <span class="kc">null</span><span class="p">)</span><span class="o">:*</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nx">owningGroup</span><span class="p">.</span><span class="nx">getManager</span><span class="p">(</span><span class="nx">PropertyManager</span><span class="p">).</span><span class="nx">getProperty</span><span class="p">(</span><span class="k">this</span><span class="o">,</span> <span class="nx">property</span><span class="o">,</span> <span class="nx">defaultValue</span><span class="p">);</span>
        <span class="p">}</span>
        </pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Set a value on this game object in a data driven way. 
@param property Property string to look up, ie "@componentName.fieldName"
@param value Value to set if the property is found.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="kd">function</span> <span class="nx">setProperty</span><span class="p">(</span><span class="nx">property</span><span class="o">:</span><span class="nb">String</span><span class="o">,</span> <span class="nx">value</span><span class="o">:*</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
        <span class="p">{</span>
            <span class="nx">owningGroup</span><span class="p">.</span><span class="nx">getManager</span><span class="p">(</span><span class="nx">PropertyManager</span><span class="p">).</span><span class="nx">setProperty</span><span class="p">(</span><span class="k">this</span><span class="o">,</span> <span class="nx">property</span><span class="o">,</span> <span class="nx">value</span><span class="p">);</span>            
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 