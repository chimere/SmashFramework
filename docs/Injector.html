<!DOCTYPE html>  <html> <head>   <title>Injector.as</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">        <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                   <b> 1. First Steps </b>                          <a class="source" href="PBEDemos.html">       PBEDemos.as      </a>                          <a class="source" href="SimplestRendererScene.html">       SimplestRendererScene.as      </a>                          <a class="source" href="SimplestSpriteRenderer.html">       SimplestSpriteRenderer.as      </a>                          <a class="source" href="BindingDemoScene.html">       BindingDemoScene.as      </a>                          <a class="source" href="SimplestSpatialComponent.html">       SimplestSpatialComponent.as      </a>                          <a class="source" href="MouseFollowerScene.html">       MouseFollowerScene.as      </a>                          <a class="source" href="SimplestMouseFollowComponent.html">       SimplestMouseFollowComponent.as      </a>                          <a class="source" href="CirclePickupScene.html">       CirclePickupScene.as      </a>                          <a class="source" href="GemManager.html">       GemManager.as      </a>                          <b> 2. Building Gameplay </b>                          <a class="source" href="CirclePickupWithTimeManagerScene.html">       CirclePickupWithTimeManagerScene.as      </a>                          <a class="source" href="OneButtonDemoScene.html">       OneButtonDemoScene.as      </a>                          <a class="source" href="OneButtonWithTweenDemoScene.html">       OneButtonWithTweenDemoScene.as      </a>                          <a class="source" href="TwoButtonDemoScene.html">       TwoButtonDemoScene.as      </a>                          <a class="source" href="CarDemoScene.html">       CarDemoScene.as      </a>                          <a class="source" href="FSMDemoScene.html">       FSMDemoScene.as      </a>                               </div>         </div>       </div>      <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs" colspan="2">             <h1>               Injector.as             </h1>           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <hr />

<p>ZaaImbue
Copyright (c) 2011 ZaaLabs, Ltd.
For more information see http://www.zaalabs.com</p>

<p>This file is licensed under the terms of the MIT license, which is included
in the license.txt file at the root directory of this library.</p>

<p>This file has been modified to reuse existing PBE type utility code and be
even simpler, which is why it is in com.pblabs.util instead of
com.zaalabs.imbue. This variant is maintained by the PBE team.</p>

<p>Other changes by PBE team:
     - Error if injection can't be fulfilled.
     - Parent injector support.
<strong><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em>*</strong>/</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">package</span> <span class="nx">com</span><span class="p">.</span><span class="nx">pblabs</span><span class="p">.</span><span class="nx">util</span>
<span class="p">{</span>
    
    <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">pblabs</span><span class="p">.</span><span class="nx">pb_internal</span><span class="o">;</span>
    
    <span class="kd">import</span> <span class="nx">flash</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nb">Dictionary</span><span class="o">;</span>
    <span class="kd">import</span> <span class="nx">flash</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">describeType</span><span class="o">;</span>
    <span class="kd">import</span> <span class="nx">flash</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">getDefinitionByName</span><span class="o">;</span>
    
    <span class="nx">use</span> <span class="kd">namespace</span> <span class="nx">pb_internal</span><span class="o">;</span>
    </pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>The Default implementation for the IInjector interface. It provides
some basic functionality for getting an dependency injection system
going. Nothing fancy or magical going on here, Pretty straightforward</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">public</span> <span class="kd">class</span> <span class="nx">Injector</span>
    <span class="p">{</span>
        </pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Maps a value to a certain class, so when <code>apply()</code>
is called, the value will be injected into any property with the
[Inject] tag over it and that matches the class definition specified
in the <code>toClass</code> parameter.</p>

<p>@param value The dependency that will be injected
@param toClass The class that the dependency will be injected into</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="kd">function</span> <span class="nx">mapValue</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="nb">Object</span><span class="o">,</span> <span class="nx">toClass</span><span class="o">:</span><span class="nb">Class</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
        <span class="p">{</span>
            <span class="nx">mappedValues</span><span class="p">[</span><span class="nx">toClass</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="o">;</span>
        <span class="p">}</span>
        
        <span class="kd">public</span> <span class="kd">function</span> <span class="nx">getMapping</span><span class="p">(</span><span class="nx">clazz</span><span class="o">:</span><span class="nb">Class</span><span class="p">)</span><span class="o">:*</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">mappedValues</span><span class="p">[</span><span class="nx">clazz</span><span class="p">])</span>
                <span class="k">return</span> <span class="nx">mappedValues</span><span class="p">[</span><span class="nx">clazz</span><span class="p">];</span>
            
            <span class="k">if</span><span class="p">(</span><span class="nx">parentInjector</span><span class="p">)</span>
                <span class="k">return</span> <span class="nx">parentInjector</span><span class="p">.</span><span class="nx">getMapping</span><span class="p">(</span><span class="nx">clazz</span><span class="p">);</span>
            
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>            
        <span class="p">}</span>
        </pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Applies the injection to the specified object. If you wish to have a
property injected into the specified object, make sure that an [Inject]
metadata tag is added to the desired target property and the value is
mapped in this injector using the <code>mapValue()</code> method.</p>

<p>@param value the object that will be injected</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="kd">function</span> <span class="nx">apply</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="nb">Object</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
        <span class="p">{</span>
            <span class="k">var</span> <span class="nx">definition</span><span class="o">:</span><span class="nb">Class</span> <span class="o">=</span> <span class="nx">TypeUtility</span><span class="p">.</span><span class="nx">getClass</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
            <span class="k">var</span> <span class="nx">targets</span><span class="o">:</span><span class="nx">Vector</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">InjectionTarget</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">getInjectionTargets</span><span class="p">(</span><span class="nx">definition</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">Vector</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">InjectionTarget</span><span class="o">&gt;;</span>
            <span class="k">var</span> <span class="nx">postConstruct</span><span class="o">:</span><span class="nx">Vector</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">PostInjectionTarget</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">getPostConstructTargets</span><span class="p">(</span><span class="nx">definition</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">Vector</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">PostInjectionTarget</span><span class="o">&gt;;</span>
            </pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>apply injections to each target</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">for</span> <span class="k">each</span><span class="p">(</span><span class="k">var</span> <span class="nx">target</span><span class="o">:</span><span class="nx">InjectionTarget</span> <span class="k">in</span> <span class="nx">targets</span><span class="p">)</span> 
            <span class="nx">applyToTarget</span><span class="p">(</span><span class="nx">target</span><span class="o">,</span><span class="nx">value</span><span class="p">);</span>
            
            <span class="k">if</span><span class="p">(</span><span class="nx">targets</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span>
            <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>apply post construct</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="k">for</span> <span class="k">each</span><span class="p">(</span><span class="k">var</span> <span class="nx">pcTarget</span><span class="o">:</span><span class="nx">PostInjectionTarget</span> <span class="k">in</span> <span class="nx">postConstruct</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">var</span> <span class="nx">f</span><span class="o">:</span><span class="nb">Function</span> <span class="o">=</span> <span class="nx">value</span><span class="p">[</span><span class="nx">pcTarget</span><span class="p">.</span><span class="nx">method</span><span class="p">];</span>
                    <span class="k">if</span><span class="p">(</span><span class="nx">f</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="nx">f</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        </pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Set a parent injector to fulfill any injections this injector cannot. </p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="kd">function</span> <span class="nx">setParentInjector</span><span class="p">(</span><span class="nx">injector</span><span class="o">:</span><span class="nx">Injector</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
        <span class="p">{</span>
            <span class="nx">parentInjector</span> <span class="o">=</span> <span class="nx">injector</span><span class="o">;</span>
        <span class="p">}</span>
        </pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <hr />

<p>Constructor</p>

<hr />             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="kd">function</span> <span class="nx">Injector</span><span class="p">()</span>
        <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Initialize the member properties</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">mappedValues</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Dictionary</span><span class="p">();</span>
        <span class="p">}</span>
        </pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <hr />

<p>Protected Properties</p>

<hr />

<p>@private</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">pb_internal</span> <span class="k">var</span> <span class="nx">mappedValues</span><span class="o">:</span><span class="nb">Dictionary</span><span class="o">;</span>
        </pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>@private</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">pb_internal</span> <span class="k">var</span> <span class="nx">parentInjector</span><span class="o">:</span><span class="nx">Injector</span><span class="o">;</span>
        </pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>@private</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">protected</span> <span class="kd">static</span> <span class="k">var</span> <span class="nx">injectionTargetCache</span><span class="o">:</span><span class="nb">Dictionary</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Dictionary</span><span class="p">();</span>
        </pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>@private</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">protected</span> <span class="kd">static</span> <span class="k">var</span> <span class="nx">postConstructTargetCache</span><span class="o">:</span><span class="nb">Dictionary</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Dictionary</span><span class="p">();</span>
        </pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <hr />

<p>Protected methods</p>

<hr />

<p>Returns InjectionTargets for the specified class, from either a cached
instance or calculated on demand. This function also stores caches for
DescribeType calls.</p>

<p>Structuring calls this way makes the Injectors api more extendable by
exposing our caching mechanisms and abstracting it.</p>

<p>@param value
@return</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="kd">static</span> <span class="kd">function</span> <span class="nx">getInjectionTargets</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="nb">Class</span><span class="p">)</span><span class="o">:</span><span class="nx">Vector</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">InjectionTarget</span><span class="o">&gt;</span>
        <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Return it is we have it in the cache</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span> <span class="p">(</span><span class="nx">injectionTargetCache</span><span class="p">[</span><span class="nx">value</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="nx">injectionTargetCache</span><span class="p">[</span><span class="nx">value</span><span class="p">]</span> <span class="nx">as</span> <span class="nx">Vector</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">InjectionTarget</span><span class="o">&gt;;</span>
            <span class="p">}</span>
            </pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Look over the xml type definition and create injector targets</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">var</span> <span class="nx">result</span><span class="o">:</span><span class="nx">Vector</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">InjectionTarget</span><span class="o">&gt;</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vector</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">InjectionTarget</span><span class="o">&gt;</span><span class="p">();</span>
            
            <span class="k">var</span> <span class="nx">definition</span><span class="o">:</span><span class="nb">XML</span> <span class="o">=</span> <span class="nx">TypeUtility</span><span class="p">.</span><span class="nx">getTypeDescription</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
            <span class="k">var</span> <span class="nx">target</span><span class="o">:</span><span class="nx">InjectionTarget</span><span class="o">;</span>
            
            <span class="k">for</span> <span class="k">each</span> <span class="p">(</span><span class="k">var</span> <span class="nx">node</span><span class="o">:</span><span class="nb">XML</span> <span class="k">in</span> <span class="nx">definition</span><span class="p">.</span><span class="nx">factory</span><span class="p">.</span><span class="o">*</span><span class="p">.(</span><span class="nx">name</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;variable&#39;</span> <span class="o">||</span> <span class="nx">name</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;accessor&#39;</span><span class="p">).</span><span class="nx">metadata</span><span class="p">.(</span><span class="err">@</span><span class="nx">name</span> <span class="o">==</span> <span class="s1">&#39;Inject&#39;</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="nx">target</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">InjectionTarget</span><span class="p">();</span>
                <span class="nx">target</span><span class="p">.</span><span class="nx">property</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">parent</span><span class="p">().</span><span class="err">@</span><span class="nx">name</span><span class="o">;</span>
                <span class="nx">target</span><span class="p">.</span><span class="nx">definition</span> <span class="o">=</span> <span class="nx">getDefinitionByName</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">parent</span><span class="p">().</span><span class="err">@</span><span class="nx">type</span><span class="p">)</span> <span class="nx">as</span> <span class="nb">Class</span><span class="o">;</span>
                <span class="nx">target</span><span class="p">.</span><span class="nx">uri</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">parent</span><span class="p">().</span><span class="err">@</span><span class="nx">uri</span><span class="o">;</span>
                <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
            <span class="p">}</span>
            
            <span class="k">return</span> <span class="nx">result</span><span class="o">;</span>
        <span class="p">}</span>
        
        <span class="kd">public</span> <span class="kd">static</span> <span class="kd">function</span> <span class="nx">getPostConstructTargets</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="nb">Class</span><span class="p">)</span><span class="o">:</span><span class="nx">Vector</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">PostInjectionTarget</span><span class="o">&gt;</span>
        <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>try to find it in the cache</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span><span class="p">(</span><span class="nx">postConstructTargetCache</span><span class="p">[</span><span class="nx">value</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="nx">postConstructTargetCache</span><span class="p">[</span><span class="nx">value</span><span class="p">]</span> <span class="nx">as</span> <span class="nx">Vector</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">PostInjectionTarget</span><span class="o">&gt;;</span>
            <span class="p">}</span>
            </pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Look over the xml type definition and create injector targets</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">var</span> <span class="nx">result</span><span class="o">:</span><span class="nx">Vector</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">PostInjectionTarget</span><span class="o">&gt;</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vector</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">PostInjectionTarget</span><span class="o">&gt;</span><span class="p">();</span>
            
            <span class="k">var</span> <span class="nx">definition</span><span class="o">:</span><span class="nb">XML</span> <span class="o">=</span> <span class="nx">TypeUtility</span><span class="p">.</span><span class="nx">getTypeDescription</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
            <span class="k">var</span> <span class="nx">target</span><span class="o">:</span><span class="nx">PostInjectionTarget</span><span class="o">;</span>
            
            <span class="k">for</span> <span class="k">each</span> <span class="p">(</span><span class="k">var</span> <span class="nx">node</span><span class="o">:</span><span class="nb">XML</span> <span class="k">in</span> <span class="nx">definition</span><span class="p">.</span><span class="nx">factory</span><span class="p">.</span><span class="o">*</span><span class="p">.(</span><span class="nx">name</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;method&#39;</span><span class="p">).</span><span class="nx">metadata</span><span class="p">.(</span><span class="err">@</span><span class="nx">name</span> <span class="o">==</span> <span class="s1">&#39;PostInject&#39;</span><span class="p">))</span> 
            <span class="p">{</span>
                <span class="nx">target</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PostInjectionTarget</span><span class="p">();</span>
                <span class="nx">target</span><span class="p">.</span><span class="nx">method</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">parent</span><span class="p">().</span><span class="err">@</span><span class="nx">name</span><span class="o">;</span>
                <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
            <span class="p">}</span>
            
            <span class="k">return</span> <span class="nx">result</span><span class="o">;</span>
        <span class="p">}</span>
        
        <span class="kd">protected</span> <span class="kd">function</span> <span class="nx">applyToTarget</span><span class="p">(</span><span class="nx">target</span><span class="o">:</span><span class="nx">InjectionTarget</span><span class="o">,</span><span class="nx">value</span><span class="o">:</span><span class="nb">Object</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
        <span class="p">{</span>
            <span class="k">var</span> <span class="nx">injectedValue</span><span class="o">:</span><span class="nb">Object</span> <span class="o">=</span> <span class="nx">mappedValues</span><span class="p">[</span><span class="nx">target</span><span class="p">.</span><span class="nx">definition</span><span class="p">];</span>
            
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">injectedValue</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">parentInjector</span><span class="p">)</span>
                    <span class="nx">parentInjector</span><span class="p">.</span><span class="nx">applyToTarget</span><span class="p">(</span><span class="nx">target</span><span class="o">,</span> <span class="nx">value</span><span class="p">);</span>
                <span class="k">else</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;No rule for injecting &quot;</span> <span class="o">+</span> <span class="nx">target</span><span class="p">.</span><span class="nx">definition</span> <span class="o">+</span> <span class="s2">&quot; into &quot;</span> <span class="o">+</span> <span class="nx">TypeUtility</span><span class="p">.</span><span class="nx">getClass</span><span class="p">(</span><span class="nx">value</span><span class="p">).</span><span class="nx">toString</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;!&quot;</span><span class="p">);</span>
                
                <span class="k">return</span><span class="o">;</span>
            <span class="p">}</span>
            
            <span class="k">if</span><span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">uri</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Inject the regular way</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="nx">value</span><span class="p">[</span><span class="nx">target</span><span class="p">.</span><span class="nx">property</span><span class="p">]</span> <span class="o">=</span> <span class="nx">injectedValue</span><span class="o">;</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Cannot inject into namespaced variable &quot;</span> <span class="o">+</span> <span class="nx">target</span><span class="p">.</span><span class="nx">property</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Simple Class for holding Injection information</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">class</span> <span class="nx">InjectionTarget</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nx">property</span><span class="o">:</span><span class="nb">String</span><span class="o">;</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nx">definition</span><span class="o">:</span><span class="nb">Class</span><span class="o">;</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nx">uri</span><span class="o">:</span><span class="nb">String</span><span class="o">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Simple Class for holding Post Injection information</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">class</span> <span class="nx">PostInjectionTarget</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nx">method</span><span class="o">:</span><span class="nb">String</span><span class="o">;</span>
<span class="p">}</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 