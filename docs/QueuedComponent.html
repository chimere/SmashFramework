<!DOCTYPE html>  <html> <head>   <title>QueuedComponent.as</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">        <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                   <b> 1. First Steps </b>                          <a class="source" href="PBEDemos.html">       PBEDemos.as      </a>                          <a class="source" href="SimplestRendererScene.html">       SimplestRendererScene.as      </a>                          <a class="source" href="SimplestSpriteRenderer.html">       SimplestSpriteRenderer.as      </a>                          <a class="source" href="BindingDemoScene.html">       BindingDemoScene.as      </a>                          <a class="source" href="SimplestSpatialComponent.html">       SimplestSpatialComponent.as      </a>                          <a class="source" href="MouseFollowerScene.html">       MouseFollowerScene.as      </a>                          <a class="source" href="SimplestMouseFollowComponent.html">       SimplestMouseFollowComponent.as      </a>                          <a class="source" href="CirclePickupScene.html">       CirclePickupScene.as      </a>                          <a class="source" href="GemManager.html">       GemManager.as      </a>                          <b> 2. Building Gameplay </b>                          <a class="source" href="CirclePickupWithTimeManagerScene.html">       CirclePickupWithTimeManagerScene.as      </a>                          <a class="source" href="OneButtonDemoScene.html">       OneButtonDemoScene.as      </a>                          <a class="source" href="OneButtonWithTweenDemoScene.html">       OneButtonWithTweenDemoScene.as      </a>                          <a class="source" href="TwoButtonDemoScene.html">       TwoButtonDemoScene.as      </a>                          <a class="source" href="CarDemoScene.html">       CarDemoScene.as      </a>                          <a class="source" href="FSMDemoScene.html">       FSMDemoScene.as      </a>                               </div>         </div>       </div>      <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs" colspan="2">             <h1>               QueuedComponent.as             </h1>           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <hr />

<p>PushButton Engine
Copyright (C) 2009 PushButton Labs, LLC
For more information see http://www.pushbuttonengine.com</p>

<p>This file is licensed under the terms of the MIT license, which is included
in the License.html file at the root directory of this SDK.
<strong><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em><em>*</em>*</strong>/</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">package</span> <span class="nx">com</span><span class="p">.</span><span class="nx">pblabs</span><span class="p">.</span><span class="nx">time</span>
<span class="p">{</span>
    <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">pblabs</span><span class="p">.</span><span class="nx">core</span><span class="p">.</span><span class="nx">PBComponent</span><span class="o">;</span>
    <span class="kd">import</span> <span class="nx">com</span><span class="p">.</span><span class="nx">pblabs</span><span class="p">.</span><span class="nx">time</span><span class="p">.</span><span class="nx">TimeManager</span><span class="o">;</span>
    </pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Base class for components which want to use think notifications.</p>

<p>"Think notifications" allow a component to specify a time and
callback function which should be called back at that time. In this
way you can easily build complex behavior (by changing which callback
you pass) which is also efficient (because it is only called when 
needed, not every tick/frame). It is also light on the GC because
no allocations are required beyond the initial allocation of the
ThinkingComponent.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">public</span> <span class="kd">class</span> <span class="nx">QueuedComponent</span> <span class="kd">extends</span> <span class="nx">PBComponent</span> <span class="kd">implements</span> <span class="nx">IQueued</span>
    <span class="p">{</span>
        <span class="kd">protected</span> <span class="k">var</span> <span class="nx">_nextThinkTime</span><span class="o">:</span><span class="nb">int</span><span class="o">;</span>
        <span class="kd">protected</span> <span class="k">var</span> <span class="nx">_nextThinkCallback</span><span class="o">:</span><span class="nb">Function</span><span class="o">;</span>
        
        <span class="p">[</span><span class="nx">Inject</span><span class="p">]</span>
        <span class="kd">public</span> <span class="k">var</span> <span class="nx">timeManager</span><span class="o">:</span><span class="nx">TimeManager</span><span class="o">;</span>
        </pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Schedule the next time this component should think. 
@param nextCallback Function to be executed.
@param timeTillThink Time in ms from now at which to execute the function (approximately).</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">public</span> <span class="kd">function</span> <span class="nx">think</span><span class="p">(</span><span class="nx">nextCallback</span><span class="o">:</span><span class="nb">Function</span><span class="o">,</span> <span class="nx">timeTillThink</span><span class="o">:</span><span class="nb">int</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
        <span class="p">{</span>
            <span class="nx">_nextThinkTime</span> <span class="o">=</span> <span class="nx">timeManager</span><span class="p">.</span><span class="nx">virtualTime</span> <span class="o">+</span> <span class="nx">timeTillThink</span><span class="o">;</span>
            <span class="nx">_nextThinkCallback</span> <span class="o">=</span> <span class="nx">nextCallback</span><span class="o">;</span>
            
            <span class="nx">timeManager</span><span class="p">.</span><span class="nx">queueObject</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="kd">public</span> <span class="kd">function</span> <span class="nx">unthink</span><span class="p">()</span><span class="o">:</span><span class="nx">void</span>
        <span class="p">{</span>
            <span class="nx">timeManager</span><span class="p">.</span><span class="nx">dequeueObject</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="kd">override</span> <span class="kd">protected</span> <span class="kd">function</span> <span class="nx">onRemove</span><span class="p">()</span> <span class="o">:</span> <span class="nx">void</span>
        <span class="p">{</span>
            <span class="kd">super</span><span class="p">.</span><span class="nx">onRemove</span><span class="p">();</span>
            </pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Do not allow us to be called back if we are still
in the queue.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">_nextThinkCallback</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="p">}</span>
        
        <span class="kd">public</span> <span class="kd">function</span> <span class="kd">get</span> <span class="nx">nextThinkTime</span><span class="p">()</span><span class="o">:</span><span class="nb">Number</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nx">_nextThinkTime</span><span class="o">;</span>
        <span class="p">}</span>
        
        <span class="kd">public</span> <span class="kd">function</span> <span class="kd">get</span> <span class="nx">nextThinkCallback</span><span class="p">()</span><span class="o">:</span><span class="nb">Function</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nx">_nextThinkCallback</span><span class="o">;</span>
        <span class="p">}</span>
        
        <span class="kd">public</span> <span class="kd">function</span> <span class="kd">get</span> <span class="nx">priority</span><span class="p">()</span><span class="o">:</span><span class="nb">int</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="o">-</span><span class="nx">_nextThinkTime</span><span class="o">;</span>
        <span class="p">}</span>
        
        <span class="kd">public</span> <span class="kd">function</span> <span class="kd">set</span> <span class="nx">priority</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="nb">int</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span>
        <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Unimplemented.&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 